<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Excel Data</title>
    <script src="xlsx.full.min.js"></script>
</head>
<body>
    <h1>Search Excel Data</h1>
    <input type="text" id="searchInput" placeholder="Enter student name">
    <button id="searchButton">Search1</button>
    <div id="results"></div>

    <script>
        document.getElementById('searchButton').addEventListener('click', () => {
            const searchInput = document.getElementById('searchInput').value;
            fetchExcelAndSearch(searchInput);
        });

        async function fetchExcelAndSearch(studentName) {
            try {
                const response = await fetch('data.xls', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
                    }
                });
                const arrayBuffer = await response.arrayBuffer();
                const data = new Uint8Array(arrayBuffer);
                const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];
                const jsonData = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);

                const results = jsonData.filter(student => studentName === student['اسم الطالب عربي']);
                displayResults(results);
            } catch (error) {
                console.error('Error fetching or processing data:', error);
            }
        }

        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            if (results.length > 0) {
                results.forEach(result => {
                    const studentInfo = `
                        <div>
                            <h2>${result['اسم الطالب عربي']}</h2>
                            <p>ID: ${result['رقم بطاقة التعريف']}</p>
                            <p>Phone: ${result['جوال العائلة']}</p>
                            <p>Department: ${result['الشعبة']}</p>
                            <!-- Add more fields here as needed -->
                        </div>
                    `;
                    resultsDiv.innerHTML += studentInfo;
                });
            } else {
                resultsDiv.innerHTML = '<p>No results found.</p>';
            }
        }
    </script>
</body>
</html>
